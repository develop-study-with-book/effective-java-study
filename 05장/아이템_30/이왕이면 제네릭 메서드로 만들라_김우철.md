## ì•„ì´í…œ 30. ì´ì™•ì´ë©´ ì œë„¤ë¦­ ë©”ì„œë“œë¡œ ë§Œë“¤ë¼

### ì œë„¤ë¦­ ë©”ì„œë“œ

Collectionsì˜ 'ì•Œê³ ë¦¬ì¦˜' ë©”ì„œë“œ(binarySearch, sort ë“±)ëŠ” ëª¨ë‘ ì œë„¤ë¦­ì´ë‹¤.

```java
public static <T> int binarySearch(List<? extends Comparable<? super T>> list, T key) {
        // ...
    }

@Override
public void sort(Comparator<? super E> c) { 
    throw new UnsupportedOperationException();
}
```

#### ì œë„¤ë¦­ ë©”ì„œë“œ ì‚¬ìš©ì „
- ë¡œìš°íƒ€ì…(ì–¸ì²´í¬)ì— ëŒ€í•œ ê²½ê³  ë°œìƒ

```java
public static Set union(Set s1, Set s2){
        Set result = new HashSet(s1);
        result.addAll(s2);
        return result;
}

Set<String> guys = Set.of("í†°", "ë”•", "í•´ë¦¬");
Set<String> stooges = Set.of("ë˜ë¦¬", "ëª¨ì—", "ì»¬ë¦¬");
Set<String> all = union(guys, stooges);
```
- ìœ„ì™€ ê°™ì€ ê²½ê³  ë°œìƒ
- íƒ€ì…ì„ ì²´í¬í•  ìˆ˜ ì—†ë‹¤ëŠ” ê²½ê³ 

#### ì œë„¤ë¦­ ë©”ì„œë“œ ì‚¬ìš© í›„

```java
public static <E> Set<E> union(Set<E> s1, Set<E> s2) {
        Set<E> result = new HashSet<>(s1);
        result.addAll(s2);
        return result;
    }
```

- ì„¸ ì§‘í•©(ì…ë ¥ 2ê°œ, ë°˜í™˜ 1ê°œ)ì˜ ì›ì†Œíƒ€ì…ì„ íƒ€ì… ë§¤ê°œë³€ìˆ˜ë¡œ ëª…ì‹œ
- ë©”ì„œë“œ ì•ˆì—ì„œë„ ì´ íƒ€ì… ë§¤ê°œë³€ìˆ˜ë§Œ ì‚¬ìš©
- (íƒ€ì… ë§¤ê°œë³€ìˆ˜ë“¤ì„ ì„ ì–¸í•˜ëŠ”) íƒ€ì… ë§¤ê°œë³€ìˆ˜ ëª©ë¡ì€ ë©”ì„œë“œì˜ ì œí•œì(public)ì™€ ë°˜í™˜ íƒ€ì…(`Set<E>`) ì‚¬ì´ì— ì˜¨ë‹¤
    - íƒ€ì… ë§¤ê°œë³€ìˆ˜ ëª©ë¡: `<E>`
    - ë°˜í™˜ íƒ€ì…: `Set<E>`
- ì´ ë©”ì†Œë“œëŠ” íƒ€ì…ì´ ëª¨ë‘ ê°™ì•„ì•¼ í•œë‹¤.
  - `public static <E, T> Set<E> union(Set<E> s1, Set<T> s2)` ëŠ” ì»´íŒŒì¼ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.

```java
    public static void main(String[] args) {
        Set<String> guys = Set.of("í†°", "ë”•", "í•´ë¦¬");
        Set<String> stooges = Set.of("ë˜ë¦¬", "ëª¨ì—", "ì»¬ë¦¬");
        Set<Integer> integers = Set.of(1,2,3);
        
        Set<String> all = union(guys, stooges); //ì •ìƒ
        Set<String> all = union(guys, integers); //ì»´íŒŒì¼ ì—ëŸ¬(íƒ€ì…ì´ ë‹¬ë¼ì„œ)
```
- union ë©”ì„œë“œ ì‚¬ìš©ì‹œ ì¸ìë¡œ ë„˜ê²¨ì£¼ëŠ” íƒ€ì…ì´ ëª¨ë‘ ê°™ì•„ì•¼ í•œë‹¤.

#### í•œì •ì  ì™€ì¼ë“œ ì¹´ë“œ íƒ€ì…
- ì´ë¥¼ **í•œì •ì  ì™€ì¼ë“œ ì¹´ë“œ íƒ€ì…**ì„ ì‚¬ìš©í•˜ë©´ ë” ìœ ì—°í•˜ê²Œ ê°œì„ í•  ìˆ˜ ìˆë‹¤.
```java
    public static <E> Set<E> union2(Set<? extends E> s1, Set<? extends E> s2) {
        Set<E> result = new HashSet<>(s1);
        result.addAll(s2);
        return result;
    }
    
       // ì½”ë“œ 30-3 ì œë„¤ë¦­ ë©”ì„œë“œë¥¼ í™œìš©í•˜ëŠ” ê°„ë‹¨í•œ í”„ë¡œê·¸ë¨ (177ìª½)
    public static void main(String[] args) {
        Set<String> guys = Set.of("í†°", "ë”•", "í•´ë¦¬");
        Set<Object> objects = Set.of(1,2,3);

        Set<Object> strings = union2(guys, objects); // ì •ìƒ
        System.out.println(strings);
    }
```
- `Set<Object>`ì™€ `Set<String>` ê°™ì€ ë‹¤ë¥¸ íƒ€ì…ì„ ê°€ì§ˆ ìˆ˜ ìˆì§€ë§Œ, ê³µí†µ ìŠˆí¼íƒ€ì… Objectë¡œ í•©ì¹  ìˆ˜ ìˆë‹¤.

### ì œë„¤ë¦­ ì‹±ê¸€í„´ íŒ©í„°ë¦¬ë€?
- ì œë„¤ë¦­ì€ ìš”ì²­í•œ íƒ€ì… ë§¤ê°œë³€ìˆ˜ì— ë§ê²Œ ë§¤ë²ˆ ê·¸ ê°ì²´ì˜ íƒ€ì…ì„ ë°”ê¿”ì¤„ ìˆ˜ ìˆëŠ”ë° ì´ëŸ¬í•œ íŒ¨í„´ì„ ì œë„¤ë¦­ ì‹±ê¸€í„´ íŒ©í„°ë¦¬ ë¼ê³  í•œë‹¤.
- ì¦‰, **íŠ¹ì • íƒ€ì…ì˜ ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ì œë„¤ë¦­ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ì–‘í•œ íƒ€ì…ì— ëŒ€í•´ ë™ì¼í•œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” íŒ¨í„´**ì´ë‹¤.

Collections.java

```java
    @SuppressWarnings("rawtypes")
    public static final Set EMPTY_SET = new EmptySet<>();
    
    //..
    @SuppressWarnings("unchecked")
    public static <T> Comparator<T> reverseOrder() {
        return (Comparator<T>) ReverseComparator.REVERSE_ORDER;
    }
    
    
    @SuppressWarnings("unchecked")
    public static final <T> Set<T> emptySet() {
        return (Set<T>) EMPTY_SET;
    }
    
    @SuppressWarnings({"unchecked", "rawtypes"})
    public static <T> void sort(List<T> list, Comparator<? super T> c) {
        list.sort(c);
    }
```
- emptySetì€ ì œë„¤ë¦­ ì‹±ê¸€í„´ íŒ©í„°ë¦¬ì˜ ì˜ˆì‹œ
  - í•­ìƒ ë™ì¼í•œ ë¶ˆë³€ì˜ ë¹ˆ Set ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜ => ì‹±ê¸€í„´ íŒ©í„°ë¦¬
  - íƒ€ì… ë§¤ê°œë³€ìˆ˜ Të¥¼ ì‚¬ìš©í•˜ì—¬ í˜¸ì¶œ ì‹œ íƒ€ì…ì„ ì§€ì • ê°€ëŠ¥ => ì œë„¤ë¦­
- ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš© ê°€ëŠ¥
```java
Set<String> emptySet = new HashSet<>(Collections.emptySet());
Set<Integer> emptyIntegerSet = new HashSet<>(Collections.emptySet());
emptySet.add("1");
emptyIntegerSet.add(1);
```

### í•­ë“±í•¨ìˆ˜
- í•­ë“± í•¨ìˆ˜ëŠ” ìê¸°ìì‹ ì„ ê·¸ëŒ€ë¡œ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë‹¤.
- ìë°”ì˜ Function.identityë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤

```java
    /**
     * Returns a function that always returns its input argument.
     *
     * @param <T> the type of the input and output objects to the function
     * @return a function that always returns its input argument
     */
    static <T> Function<T, T> identity() {
        return t -> t;
    }
```

```java
 Map<Long, EventUser> eventUsers = eventUserRepository.findAllByUserIdAndEvent_IdIn(userId, eventIds).stream()
                .collect(toMap(EventUser::getEventId, **i -> i**));
                
 Map<Long, EventUser> eventUsers = eventUserRepository.findAllByUserIdAndEvent_IdIn(userId, eventIds).stream()
                .collect(toMap(EventUser::getEventId, **Function.identity()**));
```

- i â†’ iì™€ Function.identity()ì˜ ë¡œì§ì€ ê°™ì§€ë§Œ ì°¨ì´ê°€ í•˜ë‚˜ ìˆë‹¤.
- Function.identity()ëŠ” í•­ìƒ ê°™ì€ instanceë¥¼ ë„˜ê¸°ì§€ë§Œ, i â†’ i ëŠ” ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒˆë¡œ ìƒì„±í• ë¿ë§Œ ì•„ë‹ˆë¼, ë³„ë„ì˜ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ê°€ì§„ë‹¤. ì¦‰, **ê°ì²´ë¥¼ ìƒˆë¡œ ìƒì„±í•œë‹¤ëŠ” ëœ» (ë©”ëª¨ë¦¬ ì•„ë¼ì)**

### ì œë„¤ë¦­ ì‹±ê¸€í„´ íŒ©í„°ë¦¬ íŒ¨í„´ ì˜ˆì‹œ

```java
    // ì½”ë“œ 30-4 ì œë„¤ë¦­ ì‹±ê¸€í„´ íŒ©í„°ë¦¬ íŒ¨í„´ (178ìª½)
    private static UnaryOperator<Object> IDENTITY_FN = (t) -> t;

    @SuppressWarnings("unchecked")
    public static <T> UnaryOperator<T> identityFunction() {
        return (UnaryOperator<T>) IDENTITY_FN;
    }

    // ì½”ë“œ 30-5 ì œë„¤ë¦­ ì‹±ê¸€í„´ì„ ì‚¬ìš©í•˜ëŠ” ì˜ˆ (178ìª½)
    public static void main(String[] args) {
        String[] strings = {"ì‚¼ë² ", "ëŒ€ë§ˆ", "ë‚˜ì¼ë¡ "};
        UnaryOperator<String> sameString = identityFunction();
        for (String s : strings)
            System.out.println(sameString.apply(s));
    }
```
- UnaryOperatorëŠ” ì¸ìˆ˜ì™€ ë°˜í™˜ ê²°ê³¼ê°€ ë™ì¼í•œ íƒ€ì…ì„ ê°€ì§„ ê²½ìš°ì— ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤
- IDENTITY_FNì„ (UnaryOperator<T>) ë¡œ í˜•ë³€í™˜í•˜ë©´ ë¹„ê²€ì‚¬ í˜•ë³€í™˜ ê²½ê³ ê°€ ë°œìƒí•œë‹¤.
    - IDENTITY_FNì˜ íƒ€ì…ì¸ `UnaryOperator<Object>`ëŠ” `UnaryOperator<T>`ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì´ë‹¤.
- í•­ë“±í•¨ìˆ˜ëŠ” ì…ë ¥ ê°’ì„ ìˆ˜ì • ì—†ì´ ê·¸ëŒ€ë¡œ ë°˜í™˜í•˜ëŠ” íŠ¹ë³„í•œ í•¨ìˆ˜ ì´ë¯€ë¡œ, **Tê°€ ì–´ë–¤ íƒ€ì…ì´ë“  ê°™ì€íƒ€ì…ì„ ê·¸ëŒ€ë¡œ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì—** `UnaryOperator<T>`ë¥¼ ì‚¬ìš©í•´ë„ íƒ€ì… ì•ˆì „í•˜ë¯€ë¡œ `@SuppressWarnings("unchecked")`ë¥¼ ì‚¬ìš©

```java
    // ì½”ë“œ 30-5 ì œë„¤ë¦­ ì‹±ê¸€í„´ì„ ì‚¬ìš©í•˜ëŠ” ì˜ˆ (178ìª½)
    public static void main(String[] args) {
        String[] strings = { "ì‚¼ë² ", "ëŒ€ë§ˆ", "ë‚˜ì¼ë¡ " };
        UnaryOperator<String> sameString = identityFunction();
        for (String s : strings)
            System.out.println(sameString.apply(s));

        Number[] numbers = { 1, 2.0, 3L };
        UnaryOperator<Number> sameNumber = identityFunction();
        for (Number n : numbers)
            System.out.println(sameNumber.apply(n));
    }
```
- `UnaryOperatior<String>`, `UnaryOperator<Number>`ë¡œ ì‚¬ìš©í•˜ëŠ” ì½”ë“œ
- í˜¸ì¶œí•˜ëŠ” ì¡±ì—ì„œ íƒ€ì…ì„ ì§€ì •í•˜ë©´ ëœë‹¤.
- í˜•ë³€í™˜ì„ í•˜ì§€ ì•Šì•„ë„ ì»´íŒŒì¼ ì˜¤ë¥˜ë‚˜ ê²½ê³ ê°€ ë°œìƒí•˜ì§€ ì•ŠìŒ

### ì¬ê·€ì  íƒ€ì… í•œì •
- ì¬ê·€ì  íƒ€ì… í•œì •ì€ ì œë„¤ë¦­ íƒ€ì… íŒŒë¼ë¯¸í„°ê°€ ìì‹ ì„ í¬í•¨í•˜ëŠ” íƒ€ì…ìœ¼ë¡œ í•œì •ë˜ëŠ” íŒ¨í„´
- ì¬ê·€ì  íƒ€ì… í•œì •ì€ ì£¼ë¡œ íƒ€ì…ì˜ ìì—°ì  ìˆœì„œë¥¼ ì •í•˜ëŠ” Comparable ì¸í„°í˜ì´ìŠ¤ì™€ í•¨ê»˜ ì“°ì¸ë‹¤.

```java
public interface Comparable<T> {
  int compareTo(T o);
}
```
- íƒ€ì… ë§¤ê°œë³€ìˆ˜ TëŠ” `Comparable<T>`ë¥¼ êµ¬í˜„í•œ íƒ€ì…ì´ ë¹„êµí•  ìˆ˜ ìˆëŠ” ì›ì†Œ íƒ€ì…ì„ ì •ì˜

- **Comparableì„ êµ¬í˜„í•œ ì›ì†Œ**ì˜ ì»¬ë ‰ì…˜ì„ ì…ë ¥ë°›ëŠ” ë©”ì„œë“œë“¤ì€ ì›ì†Œë“¤ì„ ì •ë ¬, ê²€ìƒ‰, ìµœì†Ÿê°’, ìµœëŒ“ê°’ì„ êµ¬í•˜ëŠ” ì‹ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ”ë°, ì´ì™€ ê´€ë ¨ ì œì•½ì„ ì½”ë“œë¡œ í‘œí˜„

```java
public static <E extends Comparable<E>> E max(Collection<E> c);
```
- **`<E extends Comparable<E>>`ëŠ” Comparableì„ êµ¬í˜„í•œ íƒ€ì…ë§Œ ë°›ê² ë‹¤** ë¼ëŠ” ì˜ë¯¸ 
  - Stringì€ `Comparable<String>`, IntegerëŠ” `Comparable<Integer>`
      ```java
      public final class Integer extends Number
              implements **Comparable<Integer>**, Constable, ConstantDesc {
            
      public final class String
          implements java.io.Serializable, **Comparable<String>**, CharSequence,
                     Constable, ConstantDesc {
      ```

```java
// ì¬ê·€ì  íƒ€ì… í•œì •ì„ ì´ìš©í•´ ìƒí˜¸ ë¹„êµí•  ìˆ˜ ìˆìŒì„ í‘œí˜„ (179ìª½)
public class RecursiveTypeBound {
    // ì½”ë“œ 30-7 ì»¬ë ‰ì…˜ì—ì„œ ìµœëŒ“ê°’ì„ ë°˜í™˜í•œë‹¤. - ì¬ê·€ì  íƒ€ì… í•œì • ì‚¬ìš© (179ìª½)
    public static <E extends Comparable<E>> E max(Collection<E> c) {
        if (c.isEmpty())
            throw new IllegalArgumentException("ì»¬ë ‰ì…˜ì´ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.");

        E result = null;
        for (E e : c)
            if (result == null || e.compareTo(result) > 0)
                result = Objects.requireNonNull(e);

        return result;
    }

    public static void main(String[] args) {
        List<String> argList = List.of("keesun", "whiteship");
        System.out.println(max(argList));
    }
}
```
- max ë©”ì„œë“œì— ë¹ˆ ì»¬ë ‰ì…˜ì„ ê±´ë„¤ë©´ ì˜ˆì™¸ë¥¼ ë˜ì§€ë‚˜, Optional<E>ë¥¼ ë°˜í™˜í•˜ë„ë¡ ê³ ì¹˜ëŠ” í¸ì´ ì¢‹ì„ë“¯(ì´ì´í…œ 55)

```
ğŸ’¡ í•µì‹¬ ì •ë¦¬
í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì…ë ¥ ë§¤ê°œë³€ìˆ˜ì™€ ë°˜í™˜ê°’ì„ ëª…ì‹œì ìœ¼ë¡œ í˜•ë³€í™˜ í•˜ëŠ” ë©”ì„œë“œ ë³´ë‹¤ ì œë„¤ë¦­ ë©”ì„œë“œê°€ ë” ì•ˆì „í•˜ê³  ì‚¬ìš©í•˜ê¸° ì‰½ë‹¤.
```